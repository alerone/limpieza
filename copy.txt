--- Project Directories ---
.
â”œâ”€â”€ App.css
â”œâ”€â”€ README.md
â”œâ”€â”€ components.json
â”œâ”€â”€ copy.txt
â”œâ”€â”€ eslint.config.js
â”œâ”€â”€ firebase.json
â”œâ”€â”€ index.html
â”œâ”€â”€ package-lock.json
â”œâ”€â”€ package.json
â”œâ”€â”€ prompt.txt
â”œâ”€â”€ public
â”‚   â”œâ”€â”€ images
â”‚   â”‚   â”œâ”€â”€ alex.jpg
â”‚   â”‚   â”œâ”€â”€ jobibi.jpg
â”‚   â”‚   â”œâ”€â”€ me.jpg
â”‚   â”‚   â”œâ”€â”€ rubiu.jpg
â”‚   â”‚   â””â”€â”€ victor.jpg
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ vite.svg
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ assets
â”‚   â”‚   â””â”€â”€ react.svg
â”‚   â”œâ”€â”€ auth
â”‚   â”‚   â”œâ”€â”€ AuthProvider.tsx
â”‚   â”‚   â””â”€â”€ auth.ts
â”‚   â”œâ”€â”€ components
â”‚   â”‚   â”œâ”€â”€ Buttons.tsx
â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.tsx
â”‚   â”‚   â”œâ”€â”€ UserHistory.tsx
â”‚   â”‚   â”œâ”€â”€ WeekDisplay.tsx
â”‚   â”‚   â”œâ”€â”€ layout
â”‚   â”‚   â”‚   â”œâ”€â”€ BackgroundWrapper.tsx
â”‚   â”‚   â”‚   â”œâ”€â”€ MainLayout.tsx
â”‚   â”‚   â”‚   â””â”€â”€ Navbar.tsx
â”‚   â”‚   â”œâ”€â”€ loader
â”‚   â”‚   â”‚   â”œâ”€â”€ Loader.css
â”‚   â”‚   â”‚   â””â”€â”€ Loader.tsx
â”‚   â”‚   â””â”€â”€ ui
â”‚   â”‚       â”œâ”€â”€ Avatar.tsx
â”‚   â”‚       â”œâ”€â”€ TaskCard.tsx
â”‚   â”‚       â”œâ”€â”€ badge.tsx
â”‚   â”‚       â”œâ”€â”€ button.tsx
â”‚   â”‚       â”œâ”€â”€ input.tsx
â”‚   â”‚       â”œâ”€â”€ label.tsx
â”‚   â”‚       â”œâ”€â”€ separator.tsx
â”‚   â”‚       â””â”€â”€ sheet.tsx
â”‚   â”œâ”€â”€ config
â”‚   â”‚   â”œâ”€â”€ cleaners.ts
â”‚   â”‚   â””â”€â”€ env.ts
â”‚   â”œâ”€â”€ features
â”‚   â”œâ”€â”€ firebase
â”‚   â”‚   â””â”€â”€ firebase.ts
â”‚   â”œâ”€â”€ hooks
â”‚   â”‚   â”œâ”€â”€ useDashboardData.tsx
â”‚   â”‚   â”œâ”€â”€ useHistory.tsx
â”‚   â”‚   â”œâ”€â”€ useRanking.tsx
â”‚   â”‚   â”œâ”€â”€ useTitle.tsx
â”‚   â”‚   â””â”€â”€ useWeekTracker.tsx
â”‚   â”œâ”€â”€ index.css
â”‚   â”œâ”€â”€ main.tsx
â”‚   â”œâ”€â”€ pages
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”‚   â”œâ”€â”€ Login.tsx
â”‚   â”‚   â”œâ”€â”€ Profile.tsx
â”‚   â”‚   â””â”€â”€ Ranking.tsx
â”‚   â”œâ”€â”€ services
â”‚   â”‚   â”œâ”€â”€ cleaningService.ts
â”‚   â”‚   â””â”€â”€ paths.ts
â”‚   â”œâ”€â”€ types
â”‚   â”‚   â””â”€â”€ domain.ts
â”‚   â”œâ”€â”€ utils
â”‚   â”‚   â”œâ”€â”€ date.ts
â”‚   â”‚   â”œâ”€â”€ isIOS.ts
â”‚   â”‚   â”œâ”€â”€ taskRotation.ts
â”‚   â”‚   â””â”€â”€ users.ts
â”‚   â””â”€â”€ vite-env.d.ts
â”œâ”€â”€ tsconfig.app.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ tsconfig.node.json
â””â”€â”€ vite.config.ts

--- Project Files ---
--- App.css ---

--- README.md ---
# React + TypeScript + Vite

This template provides a minimal setup to get React working in Vite with HMR and some ESLint rules.

Currently, two official plugins are available:

- [@vitejs/plugin-react](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react) uses [Babel](https://babeljs.io/) for Fast Refresh
- [@vitejs/plugin-react-swc](https://github.com/vitejs/vite-plugin-react/blob/main/packages/plugin-react-swc) uses [SWC](https://swc.rs/) for Fast Refresh

## Expanding the ESLint configuration

If you are developing a production application, we recommend updating the configuration to enable type-aware lint rules:

```js
export default tseslint.config([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...

      // Remove tseslint.configs.recommended and replace with this
      ...tseslint.configs.recommendedTypeChecked,
      // Alternatively, use this for stricter rules
      ...tseslint.configs.strictTypeChecked,
      // Optionally, add this for stylistic rules
      ...tseslint.configs.stylisticTypeChecked,

      // Other configs...
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

You can also install [eslint-plugin-react-x](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-x) and [eslint-plugin-react-dom](https://github.com/Rel1cx/eslint-react/tree/main/packages/plugins/eslint-plugin-react-dom) for React-specific lint rules:

```js
// eslint.config.js
import reactX from 'eslint-plugin-react-x'
import reactDom from 'eslint-plugin-react-dom'

export default tseslint.config([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      // Other configs...
      // Enable lint rules for React
      reactX.configs['recommended-typescript'],
      // Enable lint rules for React DOM
      reactDom.configs.recommended,
    ],
    languageOptions: {
      parserOptions: {
        project: ['./tsconfig.node.json', './tsconfig.app.json'],
        tsconfigRootDir: import.meta.dirname,
      },
      // other options...
    },
  },
])
```

--- components.json ---
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "new-york",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "",
    "css": "src/index.css",
    "baseColor": "zinc",
    "cssVariables": true,
    "prefix": ""
  },
  "iconLibrary": "lucide",
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  },
  "registries": {}
}

--- eslint.config.js ---
import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import tseslint from 'typescript-eslint'
import { globalIgnores } from 'eslint/config'

export default tseslint.config([
  globalIgnores(['dist']),
  {
    files: ['**/*.{ts,tsx}'],
    extends: [
      js.configs.recommended,
      tseslint.configs.recommended,
      reactHooks.configs['recommended-latest'],
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
  },
])

--- firebase.json ---
{
  "hosting": {
    "public": "dist/",
    "ignore": [
      "firebase.json",
      "**/.*",
      "**/node_modules/**"
    ],
    "rewrites": [
      {
        "source": "**",
        "destination": "/index.html"
      }
    ]
  }
}

--- index.html ---
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Limpieza Piso</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>

--- package.json ---
{
  "name": "limpieza-piso",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite --port 5174",
    "build": "tsc -b && vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@radix-ui/react-avatar": "^1.1.11",
    "@radix-ui/react-dialog": "^1.1.15",
    "@radix-ui/react-label": "^2.1.8",
    "@radix-ui/react-separator": "^1.1.8",
    "@radix-ui/react-slot": "^1.2.4",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "firebase": "^12.1.0",
    "lucide-react": "^0.562.0",
    "react": "^19.1.1",
    "react-dom": "^19.1.1",
    "react-router-dom": "^7.8.2",
    "tailwind-merge": "^3.4.0"
  },
  "devDependencies": {
    "@eslint/js": "^9.33.0",
    "@tailwindcss/vite": "^4.1.12",
    "@types/react": "^19.1.10",
    "@types/react-dom": "^19.1.7",
    "@vitejs/plugin-react": "^5.0.0",
    "autoprefixer": "^10.4.21",
    "eslint": "^9.33.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.20",
    "globals": "^16.3.0",
    "postcss": "^8.5.6",
    "tailwindcss": "^4.1.12",
    "tailwindcss-animate": "^1.0.7",
    "tw-animate-css": "^1.4.0",
    "typescript": "~5.8.3",
    "typescript-eslint": "^8.39.1",
    "vite": "^7.1.7"
  }
}

--- prompt.txt ---
Me gustarÃ­a comentar algo del fondo, me gusta ese toque modo dark pero quiero que haya un grid de muchos iconos de limpieza moviendose en diagonal hacia arriba derecha (un grid grid, no iconos aleatoriamente posicionados) aunque eso ya para cuando toque hacerlo pero para que cambies el plan de acciÃ³n general de los cambios de diseÃ±o (en su debido momento se harÃ¡ la animaciÃ³n y el background, por ahora solo cambia el plan de acciÃ³n que habÃ­as confeccionado para que en vez de ser ese fondo con brillos moviendose sea este que te comento)

--- public/index.html ---
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Welcome to Firebase Hosting</title>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/12.2.1/firebase-app-compat.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/12.2.1/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-database-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-functions-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-messaging-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-storage-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-analytics-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-remote-config-compat.js"></script>
    <script defer src="/__/firebase/12.2.1/firebase-performance-compat.js"></script>
    <!-- 
      initialize the SDK after all desired features are loaded, set useEmulator to false
      to avoid connecting the SDK to running emulators.
    -->
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>

    <style media="screen">
      body { background: #ECEFF1; color: rgba(0,0,0,0.87); font-family: Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 0; }
      #message { background: white; max-width: 360px; margin: 100px auto 16px; padding: 32px 24px; border-radius: 3px; }
      #message h2 { color: #ffa100; font-weight: bold; font-size: 16px; margin: 0 0 8px; }
      #message h1 { font-size: 22px; font-weight: 300; color: rgba(0,0,0,0.6); margin: 0 0 16px;}
      #message p { line-height: 140%; margin: 16px 0 24px; font-size: 14px; }
      #message a { display: block; text-align: center; background: #039be5; text-transform: uppercase; text-decoration: none; color: white; padding: 16px; border-radius: 4px; }
      #message, #message a { box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24); }
      #load { color: rgba(0,0,0,0.4); text-align: center; font-size: 13px; }
      @media (max-width: 600px) {
        body, #message { margin-top: 0; background: white; box-shadow: none; }
        body { border-top: 16px solid #ffa100; }
      }
    </style>
  </head>
  <body>
    <div id="message">
      <h2>Welcome</h2>
      <h1>Firebase Hosting Setup Complete</h1>
      <p>You're seeing this because you've successfully setup Firebase Hosting. Now it's time to go build something extraordinary!</p>
      <a target="_blank" href="https://firebase.google.com/docs/hosting/">Open Hosting Documentation</a>
    </div>
    <p id="load">Firebase SDK Loading&hellip;</p>

    <script>
      document.addEventListener('DOMContentLoaded', function() {
        const loadEl = document.querySelector('#load');
        // // ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥
        // // The Firebase SDK is initialized and available here!
        //
        // firebase.auth().onAuthStateChanged(user => { });
        // firebase.database().ref('/path/to/ref').on('value', snapshot => { });
        // firebase.firestore().doc('/foo/bar').get().then(() => { });
        // firebase.functions().httpsCallable('yourFunction')().then(() => { });
        // firebase.messaging().requestPermission().then(() => { });
        // firebase.storage().ref('/path/to/ref').getDownloadURL().then(() => { });
        // firebase.analytics(); // call to activate
        // firebase.analytics().logEvent('tutorial_completed');
        // firebase.performance(); // call to activate
        //
        // // ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

        try {
          let app = firebase.app();
          let features = [
            'auth', 
            'database', 
            'firestore',
            'functions',
            'messaging', 
            'storage', 
            'analytics', 
            'remoteConfig',
            'performance',
          ].filter(feature => typeof app[feature] === 'function');
          loadEl.textContent = `Firebase SDK loaded with ${features.join(', ')}`;
        } catch (e) {
          console.error(e);
          loadEl.textContent = 'Error loading the Firebase SDK, check the console.';
        }
      });
    </script>
  </body>
</html>

--- src/App.tsx ---
import { BrowserRouter, Route, Routes } from "react-router-dom";
import { AuthProvider } from "./auth/AuthProvider";
import { ProtectedRoute } from "./components/ProtectedRoute";
import Dashboard from "./pages/Dashboard";
import LoginPage from "./pages/Login";
import { ProfilePage } from "./pages/Profile";
import { useTitle } from "./hooks/useTitle";
import { MainLayout, AuthLayout } from "./components/layout/MainLayout";
import RankingPage from "./pages/Ranking";

function App() {
  useTitle("CleanApp - Tareas");
  return (
    <BrowserRouter>
      <AuthProvider>
        <Routes>
          <Route
            path="login"
            element={
              <AuthLayout>
                <LoginPage />
              </AuthLayout>
            }
          />

          <Route
            path="/"
            element={
              <ProtectedRoute>
                <MainLayout>
                  <Dashboard />
                </MainLayout>
              </ProtectedRoute>
            }
          />
          <Route
            path="profile"
            element={
              <ProtectedRoute>
                <MainLayout>
                  <ProfilePage />
                </MainLayout>
              </ProtectedRoute>
            }
          />
          <Route path="ranking" element={<RankingPage />} />
        </Routes>
      </AuthProvider>
    </BrowserRouter>
  );
}

export default App;

--- src/auth/AuthProvider.tsx ---
import { createContext, useContext, useEffect, useState, type ReactNode } from "react";
import { authInstance } from "./auth";
import { getRedirectResult, onAuthStateChanged, type User } from "firebase/auth";

const AuthContext = createContext(null as any)

export function AuthProvider({ children }: { children: ReactNode }) {
    const [user, setUser] = useState<User | null>(null)
    const [initializing, setInitializing] = useState(true)


    useEffect(() => {
        let unsubscribe: (() => void) | undefined

        const handleRedirectAndAuthState = async () => {
            try {
                // Handle redirect result first
                const result = await getRedirectResult(authInstance)
                console.log("result", result)
                if (result) {
                    console.log("Redirect result user:", result.user)
                    setUser(result.user)
                }
            } catch (error) {
                console.error("Error handling redirect:", error)
            }

            // Then set up auth state listener
            unsubscribe = onAuthStateChanged(authInstance, (user) => {
                setUser(user)
                setInitializing(false)
            })
        }

        handleRedirectAndAuthState()

        // Cleanup function
        return () => {
            if (unsubscribe) {
                unsubscribe()
            }
        }
    }, [])

    return (
        <AuthContext.Provider value={{ user, initializing }}>
            {children}
        </AuthContext.Provider>
    )
}

export function useAuth() {
    const context = useContext(AuthContext)
    if (!context) throw new Error("useAuth must be inside AuthProvider")
    return context
}


--- src/auth/auth.ts ---
import {
    signOut,
    getAuth,
    GoogleAuthProvider,
    signInWithPopup,
    type User,
    signInWithRedirect,
    getRedirectResult,
} from "firebase/auth";
import { app } from "@/firebase/firebase";
import { isIOSSafari } from "@/utils/isIOS";

export const authInstance = getAuth(app);
const provider = new GoogleAuthProvider();
provider.setCustomParameters({
    prompt: "select_account",
});

export const auth = {
    async login(callback: (user: User) => void) {
        if (isIOSSafari()) {
            try {
                await signInWithRedirect(authInstance, provider);
            } catch (error) {
                console.error("Error en signInWithRedirect:", error);
            }
        } else {
            const result = await signInWithPopup(authInstance, provider);
            callback(result.user);
        }
    },
    async handleRedirectResult() {
        try {
            const result = await getRedirectResult(authInstance);
            console.log("user", result);
            if (result) {
                const user = result.user;
                console.log("Usuario:", user);
            }
        } catch (error) {
            console.error("Error en el login con redirect:", error);
        }
    },
    async logout(callback?: () => void) {
        await signOut(authInstance);
        if (callback) callback();
    },
};

--- src/components/Buttons.tsx ---
type ButtonProps = {
    label: string,
    className?: string,
    onButtonClick: () => void,
}

export function LoginButton({ onButtonClick }: { onButtonClick: () => void }) {
    return (
        <button
            id="loginBtn"
            className="inline-flex items-center gap-2 px-3 py-1 text-md font-semibold bg-white text-gray-800 border border-gray-300 rounded-md shadow hover:bg-gray-100"
            onClick={onButtonClick}
        >
            <svg
                className="w-5 h-5"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 48 48"
            >
                <path fill="#FFC107" d="M43.6 20.5h-1.9V20H24v8h11.3C33.4 33.2 29.1 36 24 36c-6.6 0-12-5.4-12-12s5.4-12 12-12c3.1 0 6 .9 8.2 2.7l6-6C34.5 5.1 29.5 3 24 3 12.4 3 3 12.4 3 24s9.4 21 21 21c11 0 20.3-8 20.3-21 0-1.2-.1-2.1-.3-3.5z" />
                <path fill="#FF3D00" d="M6.3 14.6l6.6 4.8C14.5 16.2 18.9 14 24 14c3.1 0 6 .9 8.2 2.7l6-6C34.5 5.1 29.5 3 24 3 16.1 3 9.2 7.8 6.3 14.6z" />
                <path fill="#4CAF50" d="M24 45c5.1 0 10-1.7 13.7-4.7l-6.3-5.2C29.6 36.4 26.9 37 24 37c-5 0-9.2-3-11-7.3l-6.6 5.1C9.1 41.8 16.1 45 24 45z" />
                <path fill="#1976D2" d="M43.6 20.5h-1.9V20H24v8h11.3c-1.2 3.3-4.4 6.4-11.3 6.4-5 0-9.2-3-11-7.3l-6.6 5.1C9.1 41.8 16.1 45 24 45c11 0 20.3-8 20.3-21 0-1.2-.1-2.1-.3-3.5z" />
            </svg>
            Iniciar sesiÃ³n con Google
        </button>
    )
}

export function PrimaryButton({ label, className, onButtonClick }: ButtonProps) {
    return (
        <button
            className={`bg-orange-300 font-bold text-md text-gray-800 ${className} px-3 py-1 hover:scale-95 hover:bg-orange-400 hover:text-white transition-all duration-300`}
            onClick={onButtonClick}
        >
            {label}
        </button>
    )
}

--- src/components/ProtectedRoute.tsx ---
import type { ReactNode } from "react";
import { useAuth } from "@/auth/AuthProvider";
import { Navigate, useLocation } from "react-router-dom";
import Loader from "./loader/Loader";

export function ProtectedRoute({ children }: { children: ReactNode }) {
    const { user, initializing } = useAuth();
    const location = useLocation();

    if (initializing) {
        return (
            <div className="flex flex-col gap-4 items-center justify-center w-screen">
                <h1 className="text-center font-bold text-white">Loading...</h1>
                <Loader />
            </div>
        );
    }

    if (!user) {
        return <Navigate to={"/login"} state={{ from: location }} replace />;
    }

    return children;
}

--- src/components/UserHistory.tsx ---
import type { HistoryItem } from "@/hooks/useHistory";
import { AlertTriangle, CalendarOff, CheckCircle2 } from "lucide-react";

export function UserHistory({ history }: { history: HistoryItem[] }) {
  const hasDebts = history.length > 0;

  return (
    <div className="w-full max-w-2xl mx-auto animate-in slide-in-from-bottom-5 duration-700 delay-100">
      {/* Cabecera de la SecciÃ³n */}
      <div className="text-center mb-6">
        <h3 className="text-xl font-bold text-white flex items-center justify-center gap-2">
          {hasDebts ? (
            <>
              <AlertTriangle className="text-status-pending" />
              <span>Historial de Pendientes</span>
            </>
          ) : (
            <>
              <CheckCircle2 className="text-status-success" />
              <span>Historial Impecable</span>
            </>
          )}
        </h3>
        <p className="text-sm text-gray-400 mt-1">
          {hasDebts
            ? `Tienes ${history.length} semanas marcadas como no completadas.`
            : "Â¡Todo al dÃ­a! No debes ninguna tarea."}
        </p>
      </div>

      {/* Lista de Deudas (Glassmorphism) */}
      {hasDebts ? (
        <div className="flex flex-col gap-3">
          {history.map((item, index) => (
            <div
              key={item.week}
              className="group flex items-center justify-between p-4 bg-white/5 border border-white/10 rounded-xl hover:bg-white/10 transition-colors"
              style={{ animationDelay: `${index * 100}ms` }}
            >
              <div className="flex items-center  gap-4">
                <div className="p-2 bg-rose-500/20 rounded-full text-rose-400 group-hover:scale-110 transition-transform">
                  <CalendarOff size={20} />
                </div>
                <div className="flex flex-col">
                  <span className="font-bold text-gray-200">{item.task}</span>
                  <span className="text-xs text-gray-500 uppercase tracking-wider">
                    Semana {item.week}
                  </span>
                </div>
              </div>

              {/* Badge visual */}
              <span className="ml-1 px-0.5 md:px-3 py-0.5 md:py-1 rounded-full text-xs font-bold bg-rose-500/10 text-rose-400 border border-rose-500/20">
                No hecho
              </span>
            </div>
          ))}
        </div>
      ) : (
        // Estado VacÃ­o (Empty State)
        <div className="flex flex-col items-center justify-center py-12 bg-white/5 border border-white/10 border-dashed rounded-2xl">
          <div className="w-16 h-16 bg-gradient-to-tr from-emerald-500/20 to-transparent rounded-full flex items-center justify-center mb-4">
            <CheckCircle2 className="w-8 h-8 text-emerald-400" />
          </div>
          <p className="text-gray-300 font-medium">EstÃ¡s libre de pecado</p>
          <p className="text-xs text-gray-500">Sigue asÃ­, mÃ¡quina.</p>
        </div>
      )}
    </div>
  );
}

--- src/components/WeekDisplay.tsx ---
import { useWeekTracker } from "@/hooks/useWeekTracker";
import { CalendarDays } from "lucide-react";

export function WeekDisplay({ className }: { className?: string }) {
    const week = useWeekTracker();

    // Formato: "12/05 - 18/05" (aprovechamos tu util)
    const [start, end] = week.split("-");

    return (
        <div
            className={`flex flex-col items-center justify-center space-y-2 ${className}`}
        >
            <div className="flex items-center gap-2 px-3 py-1 rounded-full bg-white/5 border border-white/10 backdrop-blur-md text-xs font-medium text-muted-foreground uppercase tracking-wider">
                <CalendarDays size={14} />
                <span>Semana Actual</span>
            </div>

            <div className="flex flex-col md:flex-row items-baseline gap-2 md:gap-4">
                <h2 className="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-br from-white via-white to-white/50 tracking-tight">
                    {start}
                </h2>
                <span className="text-2xl text-muted-foreground/50 font-light hidden md:inline">
                    â€”
                </span>
                <div className="w-8 h-[1px] bg-white/20 md:hidden my-1"></div>
                <h2 className="text-4xl md:text-5xl font-black text-transparent bg-clip-text bg-gradient-to-br from-white via-white to-white/50 tracking-tight">
                    {end}
                </h2>
            </div>
        </div>
    );
}

--- src/components/layout/BackgroundWrapper.tsx ---
import type { ReactNode } from "react";

interface BackgroundWrapperProps {
    children: ReactNode;
}

export function BackgroundWrapper({ children }: BackgroundWrapperProps) {
    return (
        <div className="relative min-h-screen w-full overflow-hidden bg-background">
            {/* CAPA 1: Grid de Iconos Animado */}
            {/* Usamos un contenedor mÃ¡s grande (200%) para que al moverse no se acabe el dibujo */}
            <div className="absolute inset-0 z-0 pointer-events-none overflow-hidden">
                <div className="absolute -top-[100px] -left-[100px] w-[calc(100%+200px)] h-[calc(100%+200px)] text-indigo-300 animate-scrolling-grid opacity-[0.08]">
                    <CleaningGridPattern />
                </div>
            </div>

            {/* CAPA 2: Vignette (Sombra en las esquinas para centrar la atenciÃ³n) */}
            <div className="absolute inset-0 z-0 bg-gradient-to-tr from-background via-transparent to-background/80 pointer-events-none" />

            {/* CAPA 3: Contenido de la App */}
            <div className="relative z-10 flex flex-col min-h-screen">{children}</div>
        </div>
    );
}

// Este componente dibuja el patrÃ³n repetitivo
function CleaningGridPattern() {
    const patternSize = 100; // TamaÃ±o del "azulejo" que se repite

    return (
        <svg className="h-full w-full" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <pattern
                    id="cleaning-grid"
                    x="0"
                    y="0"
                    width={patternSize}
                    height={patternSize}
                    patternUnits="userSpaceOnUse"
                >
                    {/* DEFINICIÃ“N DEL GRID */}
                    {/* Color: "currentColor" tomarÃ¡ el color del texto del padre (blanco por defecto en dark mode) */}

                    {/* trash */}
                    <g transform="translate(10, 10) scale(0.5)">
                        <path
                            d="M47.5 0C46.398438 0 45.488281 0.6875 45.1875 1.6875L34.6875 29.1875L40.59375 31.3125L50 2.8125C50.101563 2.3125 50.011719 1.804688 49.8125 1.40625C49.511719 0.804688 49.007813 0.386719 48.40625 0.1875C48.105469 0.0859375 47.800781 0 47.5 0 Z M 16.09375 4.09375C12.992188 4.09375 10.199219 5.710938 8.5 8.3125C7.898438 8.3125 7.5 8.394531 7 8.59375L8.40625 10.1875C8.707031 10.085938 8.886719 10.101563 9.1875 10L9.6875 10L9.90625 9.59375C11.105469 7.394531 13.5 6 16 6C19.199219 6 22.011719 8.210938 22.8125 11.3125L23 12.09375L24 12.09375C25.898438 12.09375 27.40625 13.394531 27.90625 15.09375L30 15.09375C29.5 12.394531 27.292969 10.292969 24.59375 10.09375C23.292969 6.492188 19.992188 4.09375 16.09375 4.09375 Z M 2.1875 5.9375C1.9375 5.914063 1.65625 5.988281 1.40625 6.1875C0.90625 6.585938 0.886719 7.195313 1.1875 7.59375L3.9375 10.9375C2.980469 12.082031 2.304688 13.457031 2.09375 15L4.09375 15C4.269531 14.066406 4.660156 13.207031 5.1875 12.46875L14.125 23.3125C14.039063 23.523438 14 23.75 14 24C14 25.101563 14.898438 26 16 26C17.101563 26 18 25.101563 18 24C18 22.898438 17.101563 22 16 22C15.914063 22 15.832031 22.019531 15.75 22.03125L2.8125 6.3125C2.664063 6.113281 2.4375 5.960938 2.1875 5.9375 Z M 1 16C0.699219 16 0.386719 16.113281 0.1875 16.3125C-0.0117188 16.613281 0 16.886719 0 17.1875L5 49.1875C5.101563 49.585938 5.5 50 6 50L23 50C20.800781 48.300781 20 45.886719 20 43.6875C20 37.289063 25.707031 32.898438 29.90625 30.5L32 17.1875C32 16.886719 32.011719 16.605469 31.8125 16.40625C31.613281 16.105469 31.300781 16 31 16L13.3125 16L16.59375 20.09375C18.492188 20.394531 20 22.101563 20 24C20 26.199219 18.199219 28 16 28C13.800781 28 12 26.199219 12 24L12 23.90625L5.5 16 Z M 33.5 30.90625C30.199219 32.40625 22 36.886719 22 43.6875C22 43.875 22.015625 44.0625 22.03125 44.25C22.042969 44.382813 22.042969 44.523438 22.0625 44.65625C22.070313 44.714844 22.082031 44.785156 22.09375 44.84375C22.117188 44.964844 22.15625 45.097656 22.1875 45.21875C22.308594 45.703125 22.496094 46.167969 22.75 46.625C22.773438 46.667969 22.789063 46.710938 22.8125 46.75C22.890625 46.878906 22.972656 47 23.0625 47.125C23.125 47.210938 23.183594 47.292969 23.25 47.375C23.28125 47.414063 23.308594 47.460938 23.34375 47.5C23.472656 47.652344 23.628906 47.796875 23.78125 47.9375C25.03125 49.144531 26.992188 50 29.90625 50C28.804688 49.199219 27.898438 48.199219 27.5 47C26 43.300781 28.59375 39.195313 30.09375 37.59375C30.492188 37.195313 31.101563 37.195313 31.5 37.59375C31.898438 37.992188 31.898438 38.601563 31.5 39C30 40.5 28.210938 43.710938 29.3125 46.3125C30.011719 48.011719 31.792969 49.199219 34.59375 50L37 50C35.398438 49.101563 34.414063 48.085938 33.8125 47.1875C32.8125 45.585938 32.5 43.800781 33 42C33.199219 41.5 33.6875 41.210938 34.1875 41.3125C34.6875 41.414063 35.007813 42 34.90625 42.5C34.707031 43.199219 34.5 44.5 35.5 46C36.5 47.398438 38.8125 49.304688 44.3125 49.90625L49 49.90625C49.5 49.90625 49.898438 49.5 50 49C50 48.601563 49.6875 48.101563 49.1875 48C49.085938 48 42.40625 46.394531 39.90625 41.59375C38.605469 39.195313 39.90625 33.1875 39.90625 33.1875L39.8125 33.1875L33.8125 31Z"
                            fill="currentColor"
                        />
                    </g>

                    {/* cleaning brush */}
                    <g transform="translate(60, 10) scale(0.8)">
                        <path
                            d="M18,14h-4c-0.6,0-1-0.4-1-1V3c0-1.7,1.3-3,3-3s3,1.3,3,3v10C19,13.6,18.6,14,18,14z"
                            fill="currentColor"
                        />
                        <path
                            d="M24.7,20l-0.3-1.6C24,17,22.8,16,21.4,16H10.6c-1.4,0-2.6,1-2.9,2.4L7.3,20H24.7z"
                            fill="currentColor"
                        />
                        <path
                            d="M6.9,22L5,30.8c-0.1,0.3,0,0.6,0.2,0.8C5.4,31.9,5.7,32,6,32h4v-5c0-0.6,0.4-1,1-1s1,0.4,1,1v5h8v-3c0-0.6,0.4-1,1-1
       s1,0.4,1,1v3h4c0.3,0,0.6-0.1,0.8-0.4c0.2-0.2,0.3-0.5,0.2-0.8L25.1,22H6.9z"
                            fill="currentColor"
                        />
                    </g>

                    {/* Spray bottle */}
                    <g transform="translate(35, 60) scale(0.05)">
                        <path
                            d="M161.702,106.172l55.071-0.985l2.543,28.688h85.604l35.161-86.062h75.888V0c0,0-139.067,0-156.901,0
        s-28.802,11.561-28.802,11.561s-54.784,53.914-70.495,68.008C133.206,103.39,161.702,106.172,161.702,106.172z"
                            fill="currentColor"
                        />
                        <polygon
                            points="425.532,42.438 454.219,34.664 454.219,16.142 425.532,5.977"
                            fill="currentColor"
                        />
                        <rect
                            x="205.594"
                            y="143.438"
                            width="114.75"
                            height="38.25"
                            fill="currentColor"
                        />
                        <path
                            d="M368.157,424.336c0-87.258-47.144-107.979-52.23-112.761s-8.415-9.219-8.415-18.781s12.833-16.677,12.833-26.641
        c0-17.528-12.307-20.311-12.307-28.678c0-14.353,10.729-13.904,10.729-25.857c0-16.381-10.7-20.368-10.7-20.368
        s-79.397-0.593-97.231,0c-73.373,118.336-72.178,239.062-72.178,239.062s0,102.797,0,131.484s13.914,31.078,13.914,31.078
        s189.547,0,203.815,0s11.771-19.125,11.771-19.125S368.157,542.672,368.157,424.336z"
                            fill="currentColor"
                        />
                        <path
                            d="M449.466,162.562c-43.48-44.771-44.159-105.188-44.159-105.188h-52.316c10.872,63.753,50.882,98.073,77.743,114.157
        c13.971,8.367,18.656,7.153,20.885,4.293C457.279,168.539,449.466,162.562,449.466,162.562z"
                            fill="currentColor"
                        />
                    </g>

                    {/* Vacuum Cleaner */}
                    <g transform="translate(80, 60) scale(0.05)">
                        <path
                            d="M256,387.178V499h68v-36.8C324,423.071,294,390.821,256,387.178z"
                            fill="currentColor"
                        />
                        <rect x="389" y="295" width="23" height="46" fill="currentColor" />
                        <path
                            d="M412,445.121V361h-33.605c-5.502,0-9.395-4.853-9.395-10.355v-65.753c0-5.502,3.893-9.892,9.395-9.892 H412v-25h-33.972c-1.056,0-2.073,0-3.028,0h-33.309C294.361,250,256,288.74,256,336.33v30.841c49,3.698,88,44.906,88,95.028V499 h36.886c-1.171-4-1.942-7.891-1.942-12.173C378.943,466.492,393,449.571,412,445.121z"
                            fill="currentColor"
                        />
                        <path
                            d="M422.073,463.904c-12.721,0-23.071,10.35-23.071,23.072c0,5.209,1.738,10.019,4.661,13.885 c1.409,0.898,2.58,2.134,3.388,3.602c4.04,3.475,9.288,5.583,15.022,5.583c12.722,0,23.072-10.35,23.072-23.071 C445.145,474.254,434.795,463.904,422.073,463.904z"
                            fill="currentColor"
                        />
                        <path
                            d="M206.037,161.355c43.947,0,79.963-35.754,79.963-79.701v-9.963c0-27.467,22.533-49.813,50-49.813 c27.467,0,50,22.346,50,49.813V195h-10v35h36v-35h-7V71.692c0-38.454-31.047-69.738-69.5-69.738 c-38.453,0-69.5,31.285-69.5,69.738v9.963c0,32.96-27.077,59.776-60.037,59.776c-43.947,0-79.963,35.754-79.963,79.701v150.177 c-11,2.77-19,13.073-19,25.331V410H76.528C71.026,410,67,414.881,67,420.383v39.85c0,5.502,4.026,9.766,9.528,9.766h119.551 c5.502,0,9.921-4.264,9.921-9.766v-39.85c0-5.502-4.419-10.383-9.921-10.383H166v-13.361c0-12.258-8-22.561-20-25.331V221.131 C146,188.171,173.077,161.355,206.037,161.355z M126,410v-13.361c0-3.388,3.097-6.639,6.485-6.639h7.637 c3.388,0,5.878,3.252,5.878,6.639V410H126z"
                            fill="currentColor"
                        />
                    </g>
                </pattern>
            </defs>

            {/* RectÃ¡ngulo infinito que usa el patrÃ³n definido arriba */}
            <rect width="100%" height="100%" fill="url(#cleaning-grid)" />
        </svg>
    );
}

--- src/components/layout/MainLayout.tsx ---
import type { ReactNode } from "react";
import { BackgroundWrapper } from "./BackgroundWrapper";
import { Navbar } from "./Navbar";

export function MainLayout({ children }: { children: ReactNode }) {
    return (
        <BackgroundWrapper>
            <Navbar />
            <main className="flex-1 container mx-auto px-4 py-6 md:py-10 animate-in fade-in duration-500">
                {children}
            </main>
        </BackgroundWrapper>
    );
}

// Layout para Login (Sin Navbar)
export function AuthLayout({ children }: { children: ReactNode }) {
    return (
        <BackgroundWrapper>
            <main className="flex-1 flex items-center justify-center p-4 animate-in zoom-in-95 duration-500">
                {children}
            </main>
        </BackgroundWrapper>
    );
}

--- src/components/layout/Navbar.tsx ---
import { useState } from "react";
import { useNavigate, useLocation } from "react-router-dom";
import {
  Menu,
  LogOut,
  User,
  LayoutDashboard,
  Sparkles,
  Trophy,
} from "lucide-react";
import { useAuth } from "@/auth/AuthProvider";
import { auth } from "@/auth/auth";
import { Avatar } from "@/components/ui/Avatar";
import { Button } from "@/components/ui/button";
import {
  Sheet,
  SheetContent,
  SheetHeader,
  SheetTitle,
  SheetTrigger,
} from "@/components/ui/sheet";
import { CLEANERS } from "@/config/cleaners";

export function Navbar() {
  const navigate = useNavigate();
  const location = useLocation();
  const { user } = useAuth();
  const [isOpen, setIsOpen] = useState(false);

  // Obtener datos del perfil actual
  const userProfile = Object.values(CLEANERS).find(
    (c) => c.email === user?.email,
  );

  const handleNavigation = (path: string) => {
    navigate(path);
    setIsOpen(false);
  };

  const handleLogout = async () => {
    await auth.logout();
    setIsOpen(false);
  };

  const isActive = (path: string) => location.pathname === path;

  return (
    <nav className="sticky top-0 z-50 w-full border-b border-white/5 bg-black/20 backdrop-blur-xl">
      <div className="container flex h-16 items-center justify-between px-4 md:px-8 mx-auto">
        {/* LOGO / TÃTULO */}
        <div
          className="flex items-center gap-2 cursor-pointer hover:opacity-80 transition-opacity"
          onClick={() => navigate("/")}
        >
          <div className="flex h-8 w-8 items-center justify-center rounded-lg bg-primary/20 text-primary">
            <Sparkles className="h-5 w-5" />
          </div>
          <span className="text-lg font-bold tracking-tight text-white">
            Clean<span className="text-primary">App</span>
          </span>
        </div>

        {/* MENÃš DERECHA */}
        <Sheet open={isOpen} onOpenChange={setIsOpen}>
          <SheetTrigger asChild>
            <Button
              variant="ghost"
              size="icon"
              className="text-white hover:bg-white/10"
            >
              <Menu className="h-6 w-6" />
              <span className="sr-only">Abrir menÃº</span>
            </Button>
          </SheetTrigger>

          <SheetContent
            side="right"
            className="w-[300px] border-l border-white/10 bg-zinc-950/95 backdrop-blur-xl text-white"
          >
            <SheetHeader>
              <SheetTitle className="text-left text-white flex items-center gap-3 pb-6 border-b border-white/10">
                {userProfile && (
                  <Avatar
                    src={userProfile.avatarUrl}
                    alt="Profile"
                    size="sm"
                    colorTheme={userProfile.themeColor}
                  />
                )}
                <div className="flex flex-col">
                  <span className="text-sm font-bold">
                    {userProfile?.name || "Usuario"}
                  </span>
                  <span className="text-xs text-muted-foreground font-normal">
                    MenÃº Principal
                  </span>
                </div>
              </SheetTitle>
            </SheetHeader>

            <div className="flex flex-col gap-2 mt-6">
              <NavButton
                icon={<LayoutDashboard size={20} />}
                label="Panel Principal"
                active={isActive("/")}
                onClick={() => handleNavigation("/")}
              />
              <NavButton
                icon={<Trophy size={20} />}
                label="Ranking"
                active={isActive("/ranking")}
                onClick={() => handleNavigation("/ranking")}
              />
              <NavButton
                icon={<User size={20} />}
                label="Mi Perfil"
                active={isActive("/profile")}
                onClick={() => handleNavigation("/profile")}
              />
            </div>

            <div className="mt-auto pt-6 border-t border-white/10 absolute bottom-6 w-[calc(100%-3rem)]">
              <Button
                variant="destructive"
                className="w-full gap-2 font-semibold"
                onClick={handleLogout}
              >
                <LogOut size={18} />
                Cerrar SesiÃ³n
              </Button>
            </div>
          </SheetContent>
        </Sheet>
      </div>
    </nav>
  );
}

// BotÃ³n auxiliar para el menÃº
function NavButton({ icon, label, onClick, active }: any) {
  return (
    <button
      onClick={onClick}
      className={`flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all
            ${
              active
                ? "bg-primary/20 text-primary border border-primary/20"
                : "text-zinc-400 hover:text-white hover:bg-white/5"
            }`}
    >
      {icon}
      {label}
    </button>
  );
}

--- src/components/loader/Loader.css ---
.loader {
  width: 32px;
  height: 32px;
  position: relative;
  border-radius: 50%;
  color: oklch(58.5% 0.233 277.117);
  animation: fill 1s ease-in infinite alternate;
}
.loader::before , .loader::after {
  content: '';
  position: absolute;
  height: 100%;
  width: 100%;
  border-radius: 50%;
  left: 48px;
  top: 0;
  animation: fill 0.9s ease-in infinite alternate;
}

.loader::after {
  left: auto;
  right: 48px;
  animation-duration: 1.1s;
}

@keyframes fill {
 0% {  box-shadow: 0 0 0 2px inset }
 100%{ box-shadow: 0 0 0 10px inset }
}

  


--- src/components/loader/Loader.tsx ---
import "./Loader.css";

export default function Loader() {
  return <span className="loader" />;
}

--- src/components/ui/Avatar.tsx ---
import type { BrandColor } from "@/types/domain";

interface AvatarProps {
    src: string;
    alt: string;
    colorTheme?: BrandColor;
    size?: "sm" | "md" | "lg" | "xl";
    className?: string;
    onClick?: () => void;
}

// Mapeo de tamaÃ±os a clases Tailwind
const SIZES = {
    sm: "w-12 h-12 border-2",
    md: "w-20 h-20 border-4",
    lg: "w-32 h-32 border-4",
    xl: "w-48 h-48 border-8",
};

// Mapeo de colores a bordes (usando nombres de colores Tailwind estÃ¡ndar)
const BORDERS: Record<BrandColor, string> = {
    blue: "border-sky-400",
    green: "border-emerald-400",
    purple: "border-purple-400",
    yellow: "border-yellow-400",
    pink: "border-pink-400",
};

export function Avatar({
    src,
    alt,
    colorTheme = "blue",
    size = "md",
    className = "",
    onClick,
}: AvatarProps) {
    return (
        <img
            src={src}
            alt={alt}
            onClick={onClick}
            className={`
        rounded-full object-cover transition-transform duration-200
        ${SIZES[size]} 
        ${BORDERS[colorTheme]}
        ${onClick ? "cursor-pointer hover:scale-105" : ""}
        ${className}
      `}
        />
    );
}

--- src/components/ui/TaskCard.tsx ---
import { Avatar } from "./Avatar";
import type { BrandColor } from "@/types/domain";
import { Badge } from "@/components/ui/badge"; // Usamos Shadcn Badge
import { CheckCircle2, Circle, Clock } from "lucide-react";
import { cn } from "@/lib/utils"; // Utilidad de Shadcn para mezclar clases

interface TaskCardProps {
    name: string;
    avatarUrl: string;
    taskName: string;
    isDone: boolean;
    completedAt?: string | null;
    colorTheme: BrandColor;
    isInteractive: boolean;
    onToggle: () => void;
}

export function TaskCard({
    name,
    avatarUrl,
    taskName,
    isDone,
    completedAt,
    colorTheme,
    isInteractive,
    onToggle,
}: TaskCardProps) {
    return (
        <div
            onClick={isInteractive ? onToggle : undefined}
            className={cn(
                "group relative flex flex-col p-5 rounded-2xl transition-all duration-300 border",
                // Estilos Base Glassmorphism
                "bg-zinc-900/40 backdrop-blur-xl",

                // Interactividad
                isInteractive
                    ? "cursor-pointer hover:-translate-y-1 hover:bg-zinc-800/50"
                    : "opacity-80 grayscale-[0.2]",

                // ESTADO: HECHO (Borde verde y Glow)
                isDone
                    ? "border-emerald-500/50 shadow-[0_0_30px_-10px_rgba(16,185,129,0.3)] hover:shadow-[0_0_40px_-10px_rgba(16,185,129,0.5)]"
                    : "border-white/10 hover:border-white/20 hover:shadow-lg",
            )}
        >
            {/* Indicador de estado visual (Icono flotante) */}
            <div
                className={cn(
                    "absolute top-4 right-4 transition-all duration-300",
                    isDone
                        ? "text-emerald-400 scale-110"
                        : "text-muted-foreground/30 group-hover:text-muted-foreground/60",
                )}
            >
                {isDone ? <CheckCircle2 size={24} /> : <Circle size={24} />}
            </div>

            {/* Cabecera: Avatar y Nombre */}
            <div className="flex flex-col items-center gap-4 mt-2">
                <div
                    className={cn(
                        "rounded-full p-1 transition-all duration-500",
                        isDone
                            ? "bg-gradient-to-tr from-emerald-500/20 to-transparent"
                            : "",
                    )}
                >
                    <Avatar
                        src={avatarUrl}
                        alt={name}
                        colorTheme={colorTheme}
                        size="lg"
                        className={cn(
                            "transition-all duration-300",
                            isDone
                                ? "grayscale-0"
                                : "grayscale-[0.3] group-hover:grayscale-0",
                        )}
                    />
                </div>

                <div className="text-center space-y-1">
                    <h3 className="text-xl font-bold text-white tracking-tight">
                        {name}
                    </h3>
                    {/* PequeÃ±a barra decorativa del color del tema */}
                    <div
                        className={cn(
                            "h-1 w-12 mx-auto rounded-full opacity-60",
                            colorTheme === "blue" && "bg-sky-500",
                            colorTheme === "green" && "bg-emerald-500",
                            colorTheme === "purple" && "bg-purple-500",
                            colorTheme === "yellow" && "bg-yellow-500",
                            colorTheme === "pink" && "bg-pink-500",
                        )}
                    />
                </div>
            </div>

            {/* Contenido: Tarea */}
            <div className="mt-6 space-y-4">
                <div
                    className={cn(
                        "p-3 rounded-xl text-center font-bold text-lg transition-colors border",
                        isDone
                            ? "bg-emerald-500/10 border-emerald-500/20 text-emerald-200"
                            : "bg-white/5 border-white/5 text-white/80 group-hover:bg-white/10",
                    )}
                >
                    {taskName}
                </div>

                <div className="flex items-center justify-between pt-2">
                    {/* Badge de Estado */}
                    <Badge
                        variant={isDone ? "default" : "outline"}
                        className={cn(
                            "text-xs font-semibold px-3 py-1",
                            isDone
                                ? "bg-emerald-600 hover:bg-emerald-600 border-0"
                                : "text-muted-foreground border-white/20",
                        )}
                    >
                        {isDone ? "Completado" : "Pendiente"}
                    </Badge>

                    {/* Hora de completado */}
                    {isDone && completedAt && (
                        <div className="flex items-center gap-1.5 text-xs font-medium text-emerald-400/80 animate-in fade-in">
                            <Clock size={12} />
                            <span>{completedAt.split(" ")[0]}</span>{" "}
                            {/* Mostramos solo fecha o hora si prefieres */}
                        </div>
                    )}
                </div>
            </div>
        </div>
    );
}

--- src/components/ui/badge.tsx ---
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",
        destructive:
          "border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

function Badge({
  className,
  variant,
  asChild = false,
  ...props
}: React.ComponentProps<"span"> &
  VariantProps<typeof badgeVariants> & { asChild?: boolean }) {
  const Comp = asChild ? Slot : "span"

  return (
    <Comp
      data-slot="badge"
      className={cn(badgeVariants({ variant }), className)}
      {...props}
    />
  )
}

export { Badge, badgeVariants }

--- src/components/ui/button.tsx ---
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",
        outline:
          "border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost:
          "hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-9 px-4 py-2 has-[>svg]:px-3",
        sm: "h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",
        lg: "h-10 rounded-md px-6 has-[>svg]:px-4",
        icon: "size-9",
        "icon-sm": "size-8",
        "icon-lg": "size-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

function Button({
  className,
  variant = "default",
  size = "default",
  asChild = false,
  ...props
}: React.ComponentProps<"button"> &
  VariantProps<typeof buttonVariants> & {
    asChild?: boolean
  }) {
  const Comp = asChild ? Slot : "button"

  return (
    <Comp
      data-slot="button"
      data-variant={variant}
      data-size={size}
      className={cn(buttonVariants({ variant, size, className }))}
      {...props}
    />
  )
}

export { Button, buttonVariants }

--- src/components/ui/input.tsx ---
import * as React from "react"

import { cn } from "@/lib/utils"

function Input({ className, type, ...props }: React.ComponentProps<"input">) {
  return (
    <input
      type={type}
      data-slot="input"
      className={cn(
        "file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
        "focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]",
        "aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",
        className
      )}
      {...props}
    />
  )
}

export { Input }

--- src/components/ui/label.tsx ---
"use client"

import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"

import { cn } from "@/lib/utils"

function Label({
  className,
  ...props
}: React.ComponentProps<typeof LabelPrimitive.Root>) {
  return (
    <LabelPrimitive.Root
      data-slot="label"
      className={cn(
        "flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",
        className
      )}
      {...props}
    />
  )
}

export { Label }

--- src/components/ui/separator.tsx ---
import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

function Separator({
  className,
  orientation = "horizontal",
  decorative = true,
  ...props
}: React.ComponentProps<typeof SeparatorPrimitive.Root>) {
  return (
    <SeparatorPrimitive.Root
      data-slot="separator"
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",
        className
      )}
      {...props}
    />
  )
}

export { Separator }

--- src/components/ui/sheet.tsx ---
import * as React from "react"
import * as SheetPrimitive from "@radix-ui/react-dialog"
import { XIcon } from "lucide-react"

import { cn } from "@/lib/utils"

function Sheet({ ...props }: React.ComponentProps<typeof SheetPrimitive.Root>) {
  return <SheetPrimitive.Root data-slot="sheet" {...props} />
}

function SheetTrigger({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Trigger>) {
  return <SheetPrimitive.Trigger data-slot="sheet-trigger" {...props} />
}

function SheetClose({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Close>) {
  return <SheetPrimitive.Close data-slot="sheet-close" {...props} />
}

function SheetPortal({
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Portal>) {
  return <SheetPrimitive.Portal data-slot="sheet-portal" {...props} />
}

function SheetOverlay({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Overlay>) {
  return (
    <SheetPrimitive.Overlay
      data-slot="sheet-overlay"
      className={cn(
        "data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",
        className
      )}
      {...props}
    />
  )
}

function SheetContent({
  className,
  children,
  side = "right",
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Content> & {
  side?: "top" | "right" | "bottom" | "left"
}) {
  return (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content
        data-slot="sheet-content"
        className={cn(
          "bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
          side === "right" &&
            "data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",
          side === "left" &&
            "data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",
          side === "top" &&
            "data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",
          side === "bottom" &&
            "data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",
          className
        )}
        {...props}
      >
        {children}
        <SheetPrimitive.Close className="ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none">
          <XIcon className="size-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
}

function SheetHeader({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-header"
      className={cn("flex flex-col gap-1.5 p-4", className)}
      {...props}
    />
  )
}

function SheetFooter({ className, ...props }: React.ComponentProps<"div">) {
  return (
    <div
      data-slot="sheet-footer"
      className={cn("mt-auto flex flex-col gap-2 p-4", className)}
      {...props}
    />
  )
}

function SheetTitle({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Title>) {
  return (
    <SheetPrimitive.Title
      data-slot="sheet-title"
      className={cn("text-foreground font-semibold", className)}
      {...props}
    />
  )
}

function SheetDescription({
  className,
  ...props
}: React.ComponentProps<typeof SheetPrimitive.Description>) {
  return (
    <SheetPrimitive.Description
      data-slot="sheet-description"
      className={cn("text-muted-foreground text-sm", className)}
      {...props}
    />
  )
}

export {
  Sheet,
  SheetTrigger,
  SheetClose,
  SheetContent,
  SheetHeader,
  SheetFooter,
  SheetTitle,
  SheetDescription,
}

--- src/config/cleaners.ts ---
import type { CleanerProfile } from "@/types/domain";
import { ENV } from "./env";

export const CLEANERS: Record<string, CleanerProfile> = {
    alvaro: {
        id: "9d2fd7a7-2571-4f51-9794-4947de3a842d",
        username: "alvaro",
        name: "Ãlvaro",
        email: ENV.users.alvaro,
        avatarUrl: "/images/me.jpg",
        themeColor: "blue",
    },
    rubius: {
        id: "53579f58-926b-4cdf-98bc-2956c1da412c",
        username: "rubius",
        name: "RubÃ©n",
        email: ENV.users.rubius,
        avatarUrl: "/images/rubiu.jpg",
        themeColor: "yellow",
    },
    victor: {
        id: "1a7c9359-3c3e-4e21-87ca-77890359cc1f",
        username: "victor",
        name: "VÃ­ctor",
        email: ENV.users.victor,
        avatarUrl: "/images/victor.jpg",
        themeColor: "pink",
    },
    alex: {
        id: "fa59951a-20c2-436e-bb70-cde97cdee399",
        username: "alex",
        name: "Ãlex",
        email: ENV.users.alex,
        avatarUrl: "/images/alex.jpg",
        themeColor: "green",
    },
};

export const CLEANER_LIST = Object.values(CLEANERS);

--- src/config/env.ts ---
const requiredEnv = (key: string, value: string | undefined): string => {
    if (!value) throw new Error(`Missing env variable: ${key}`);
    return value;
};

export const ENV = {
    firebase: {
        apiKey: requiredEnv(
            "VITE_FIREBASE_API_KEY",
            import.meta.env.VITE_FIREBASE_API_KEY,
        ),
        authDomain: requiredEnv(
            "VITE_FIREBASE_AUTH_DOMAIN",
            import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
        ),
        databaseURL: requiredEnv(
            "VITE_FIREBASE_DB_URL",
            import.meta.env.VITE_FIREBASE_DB_URL,
        ),
        projectId: requiredEnv(
            "VITE_FIREBASE_PROJECT_ID",
            import.meta.env.VITE_FIREBASE_PROJECT_ID,
        ),
        storageBucket: requiredEnv(
            "VITE_FIREBASE_STORAGE_BUCKET",
            import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
        ),
        messagingSenderId: requiredEnv(
            "VITE_FIREBASE_MESSAGING_SENDER_ID",
            import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
        ),
        appId: requiredEnv(
            "VITE_FIREBASE_APP_ID",
            import.meta.env.VITE_FIREBASE_APP_ID,
        ),
    },
    adminEmail: import.meta.env.VITE_ADMIN_EMAIL || "",
    users: {
        alvaro: import.meta.env.VITE_EMAIL_ALVARO || "",
        rubius: import.meta.env.VITE_EMAIL_RUBIUS || "",
        victor: import.meta.env.VITE_EMAIL_VICTOR || "",
        alex: import.meta.env.VITE_EMAIL_ALEX || "",
    },
} as const;

--- src/firebase/firebase.ts ---
import { initializeApp } from "firebase/app"
import { getDatabase } from "firebase/database"

const firebaseConfig = {
    apiKey: import.meta.env.VITE_FIREBASE_API_KEY,
    authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,
    databaseURL: import.meta.env.VITE_FIREBASE_DB_URL,
    projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,
    storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,
    messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,
    appId: import.meta.env.VITE_FIREBASE_APP_ID,
    measurementId: import.meta.env.VITE_FIREBASE_MEASUREMENT_ID,
}

export const app = initializeApp(firebaseConfig)
export const db = getDatabase(app)


--- src/hooks/useDashboardData.tsx ---
import { useEffect, useState } from "react";
import { onValue, ref, off } from "firebase/database";
import { db } from "@/firebase/firebase";
import { DB_PATHS } from "@/services/paths";
import { initializeCurrentWeekIfNeeded } from "@/services/cleaningService";
import { CLEANER_LIST } from "@/config/cleaners";
import type { CleanerWithTask } from "@/types/domain";

export function useDashboardData() {
  const [data, setData] = useState<CleanerWithTask[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    let mounted = true;
    const weekPath = DB_PATHS.currentWeekRoot();
    const weekRef = ref(db, weekPath);

    const initAndSubscribe = async () => {
      try {
        // 1. Asegurar que la semana existe (Check-then-Act)
        await initializeCurrentWeekIfNeeded();

        // 2. Suscribirse a los cambios
        onValue(weekRef, (snapshot) => {
          if (!mounted) return;
          const weekData = snapshot.val();

          if (!weekData || !weekData.usuarios) {
            setLoading(false);
            return;
          }

          // 3. Mapear datos: ConfiguraciÃ³n EstÃ¡tica + Estado DinÃ¡mico
          const mergedData: CleanerWithTask[] = CLEANER_LIST.map((cleaner) => {
            // Datos crudos de Firebase para este usuario
            const userState = weekData.usuarios[cleaner.username];

            return {
              ...cleaner, // Datos base (id, nombre, avatar...)
              taskName: userState?.task || "Sin tarea",
              isDone: userState?.done || false,
              completedAt:
                userState?.fecha === "not done" ? null : userState?.fecha,
            };
          });

          setData(mergedData);
          setLoading(false);
        });
      } catch (error) {
        console.error("Error inicializando dashboard:", error);
        if (mounted) setLoading(false);
      }
    };

    initAndSubscribe();

    return () => {
      mounted = false;
      off(weekRef); // Desuscribirse al desmontar
    };
  }, []);

  return { cleaners: data, loading };
}

--- src/hooks/useHistory.tsx ---
import { useEffect, useState } from "react";
import { onValue, ref, off } from "firebase/database";
import { db } from "@/firebase/firebase";
import { DB_PATHS } from "@/services/paths";

export type HistoryItem = {
  week: string;
  task: string;
};

export function useHistory(email: string | undefined | null) {
  const [history, setHistory] = useState<HistoryItem[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    // Si no hay email (ej: no logueado o cargando), no hacemos nada
    if (!email) {
      setLoading(false);
      return;
    }

    // 1. Obtenemos la ruta centralizada (sin strings mÃ¡gicos)
    const path = DB_PATHS.userHistoryRoot(email);
    const historyRef = ref(db, path);

    // 2. SuscripciÃ³n a Firebase
    const unsubscribe = onValue(historyRef, (snapshot) => {
      const data = snapshot.val();

      if (!data) {
        setHistory([]);
      } else {
        // 3. TransformaciÃ³n de datos: { "12_05_2025": "Cocina" } -> Array
        const parsed: HistoryItem[] = Object.entries(data).map(
          ([key, task]) => ({
            // Revertimos el sanitizado: "12_05" -> "12/05"
            week: key.replaceAll("_", "/"),
            task: task as string,
          }),
        );

        // Opcional: Ordenar por fecha (string) descendente si quisieras
        setHistory(parsed.reverse());
      }
      setLoading(false);
    });

    // Cleanup al desmontar
    return () => off(historyRef, "value", unsubscribe);
  }, [email]);

  return { history, loading };
}

--- src/hooks/useRanking.tsx ---
import { useEffect, useState } from "react";
import { onValue, ref } from "firebase/database"; // Quitamos 'off'
import { db } from "@/firebase/firebase";
import { DB_PATHS } from "@/services/paths";
import { CLEANERS } from "@/config/cleaners";
import type { CleanerProfile } from "@/types/domain";

export interface RankingItem extends CleanerProfile {
  score: number;
}

export function useRanking() {
  const [ranking, setRanking] = useState<RankingItem[]>([]);
  const [loading, setLoading] = useState(true);

  useEffect(() => {
    const statsRef = ref(db, DB_PATHS.allStats());

    // onValue devuelve la funciÃ³n 'unsubscribe' directamente
    const unsubscribe = onValue(statsRef, (snapshot) => {
      const data = snapshot.val() || {};

      const parsedRanking: RankingItem[] = Object.values(CLEANERS).map(
        (cleaner) => {
          const userStats = data[cleaner.username];
          return {
            ...cleaner,
            score: userStats?.completedTasks || 0,
          };
        },
      );

      // Ordenar: MÃ¡s puntos primero
      parsedRanking.sort((a, b) => b.score - a.score);

      setRanking(parsedRanking);
      setLoading(false);
    });

    // Limpieza correcta
    return () => unsubscribe();
  }, []);

  return { ranking, loading };
}

--- src/hooks/useTitle.tsx ---
import { useEffect } from "react";

export function useTitle(title: string) {
    useEffect(() => {
        document.title = title
    }, [])
}

--- src/hooks/useWeekTracker.tsx ---
import { useEffect, useState } from "react";
import { getWeekBounds } from "@/utils/date";

export function useWeekTracker() {
    const [week, setWeek] = useState(getWeekBounds());

    useEffect(() => {
        const interval = setInterval(
            () => {
                const currentWeek = getWeekBounds();
                if (currentWeek != week) {
                    setWeek(currentWeek);
                }
                return () => clearInterval(interval);
            },
            5 * 60 * 1000,
        );
    }, [week]);

    return week;
}

--- src/index.css ---
@import "tailwindcss";

@plugin "tailwindcss-animate";

@theme {
  /* 1. Registramos los colores en el tema */
  --color-background: var(--background);
  --color-foreground: var(--foreground);

  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);

  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);

  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);

  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);

  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);

  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);

  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);

  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  /* 2. Registramos radios y fuentes */
  --radius-lg: var(--radius);
  --radius-md: calc(var(--radius) - 2px);
  --radius-sm: calc(var(--radius) - 4px);

  --font-sans: "Inter", ui-sans-serif, system-ui, sans-serif;

  /* 3. ANIMACIONES (Todo esto debe estar DENTRO de @theme) */
  --animate-accordion-down: accordion-down 0.2s ease-out;
  --animate-accordion-up: accordion-up 0.2s ease-out;
  --animate-scrolling-grid: scrolling-grid 20s linear infinite;

  @keyframes accordion-down {
    from {
      height: 0;
    }
    to {
      height: var(--radix-accordion-content-height);
    }
  }

  @keyframes accordion-up {
    from {
      height: var(--radix-accordion-content-height);
    }
    to {
      height: 0;
    }
  }

  @keyframes scrolling-grid {
    0% {
      transform: translate(0, 0);
    }
    100% {
      transform: translate(-100px, -100px);
    }
  }
}

/* 4. Valores de variables CSS (Modo Oscuro) */
:root {
  --background: hsl(240 10% 3.9%);
  --foreground: hsl(0 0% 98%);

  --card: hsl(240 10% 3.9%);
  --card-foreground: hsl(0 0% 98%);

  --popover: hsl(240 10% 3.9%);
  --popover-foreground: hsl(0 0% 98%);

  --primary: hsl(263.4 70% 50.4%);
  --primary-foreground: hsl(210 40% 98%);

  --secondary: hsl(240 3.7% 15.9%);
  --secondary-foreground: hsl(0 0% 98%);

  --muted: hsl(240 3.7% 15.9%);
  --muted-foreground: hsl(240 5% 64.9%);

  --accent: hsl(240 3.7% 15.9%);
  --accent-foreground: hsl(0 0% 98%);

  --destructive: hsl(0 62.8% 30.6%);
  --destructive-foreground: hsl(0 0% 98%);

  --border: hsl(240 3.7% 15.9%);
  --input: hsl(240 3.7% 15.9%);
  --ring: hsl(240 4.9% 83.9%);

  --radius: 0.75rem;
}

/* 5. Estilos Base */
body {
  background-color: var(--background);
  color: var(--foreground);
  font-family: var(--font-sans);
  -webkit-font-smoothing: antialiased;
  min-height: 100vh;
}

/* 6. Utilidades Glassmorphism */
.glass-panel {
  @apply bg-black/40 backdrop-blur-xl border border-white/10 shadow-2xl;
}

.glass-card {
  @apply bg-zinc-900/40 backdrop-blur-md border border-white/5 shadow-lg hover:bg-zinc-800/50 transition-all duration-300;
}

.text-gradient {
  @apply bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 via-purple-400 to-pink-400;
}

--- src/main.tsx ---
import { StrictMode } from "react";
import { createRoot } from "react-dom/client";
import "./index.css";
import App from "./App.tsx";

createRoot(document.getElementById("root")!).render(
  // <StrictMode>
  <App />,
  // </StrictMode>,
);

--- src/pages/Dashboard.tsx ---
import { useAuth } from "@/auth/AuthProvider";
import { useTitle } from "@/hooks/useTitle";
import { useDashboardData } from "@/hooks/useDashboardData";
import { toggleTaskCompletion } from "@/services/cleaningService";
import { TaskCard } from "@/components/ui/TaskCard";
import { WeekDisplay } from "@/components/WeekDisplay"; // Asumo que mantenemos este por ahora
import Loader from "@/components/loader/Loader";

export default function Dashboard() {
  useTitle("Panel - CleanApp");
  const { user } = useAuth();

  // Hook inteligente: Datos y Loading centralizados
  const { cleaners, loading } = useDashboardData();

  const handleToggle = async (cleanerId: string, taskName: string) => {
    // Buscamos el objeto completo del cleaner para pasarlo al servicio
    const cleanerToUpdate = cleaners.find((c) => c.username === cleanerId);
    if (!cleanerToUpdate) return;

    try {
      await toggleTaskCompletion(cleanerToUpdate, taskName);
    } catch (error) {
      console.error("Error al actualizar tarea:", error);
      // AquÃ­ podrÃ­as aÃ±adir un toast de error si quisieras
    }
  };

  if (loading) {
    return (
      <div className="flex h-[80vh] w-full items-center justify-center flex-col gap-4">
        <Loader />
        <p className="text-gray-500 animate-pulse">Cargando tareas...</p>
      </div>
    );
  }

  // Ordenar usuarios: Primero YO (el usuario logueado), luego el resto.
  // Mejora UX: No tengo que buscarme en la lista.
  const sortedCleaners = [...cleaners].sort((a, b) => {
    if (a.email === user?.email) return -1;
    if (b.email === user?.email) return 1;
    return 0;
  });

  return (
    <div className="flex flex-col gap-10 pb-10">
      {/* Header: InformaciÃ³n de la semana */}
      <header className="mt-8 flex justify-center animate-in fade-in slide-in-from-top-4 duration-700">
        <WeekDisplay />
      </header>

      {/* Grid de Tarjetas */}
      {/* Mobile-first: 1 columna, luego 2, luego 4 en pantallas grandes */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 px-4 md:px-0">
        {sortedCleaners.map((cleaner) => {
          const isMyCard = user?.email === cleaner.email;

          return (
            <div
              key={cleaner.id}
              className="animate-in fade-in zoom-in-95 duration-500"
            >
              <TaskCard
                name={cleaner.name}
                avatarUrl={cleaner.avatarUrl}
                taskName={cleaner.taskName}
                isDone={cleaner.isDone}
                completedAt={cleaner.completedAt}
                colorTheme={cleaner.themeColor}
                isInteractive={isMyCard}
                onToggle={() =>
                  handleToggle(cleaner.username, cleaner.taskName)
                }
              />
            </div>
          );
        })}
      </div>
    </div>
  );
}

--- src/pages/Login.tsx ---
import { useLocation, useNavigate } from "react-router-dom";
import { auth } from "@/auth/auth";
import { useAuth } from "@/auth/AuthProvider";
import { useTitle } from "@/hooks/useTitle";
import { Button } from "@/components/ui/button"; // Shadcn Button
import { Sparkles } from "lucide-react";

function LoginPage() {
    const navigate = useNavigate();
    const location = useLocation();
    const { user } = useAuth();
    const from = location.state?.from?.pathname || "/";
    useTitle("Iniciar SesiÃ³n - CleanApp");

    async function handleLogin() {
        await auth.login(() => { });
        navigate(from, { replace: true });
    }

    if (user) {
        navigate(from, { replace: true });
    }

    return (
        <div className="w-full max-w-md">
            <div className="glass-panel p-8 rounded-2xl flex flex-col items-center gap-8 text-center border-t border-white/20">
                <div className="bg-primary/20 p-4 rounded-full ring-4 ring-primary/10">
                    <Sparkles className="w-10 h-10 text-primary" />
                </div>

                <div className="space-y-2">
                    <h1 className="text-3xl font-bold tracking-tight text-white">
                        Clean<span className="text-primary">App</span>
                    </h1>
                    <p className="text-muted-foreground">
                        Gestiona la limpieza de tu piso de forma elegante.
                    </p>
                </div>

                <Button
                    size="lg"
                    className="w-full font-semibold text-md shadow-lg shadow-primary/20"
                    onClick={handleLogin}
                >
                    <svg className="mr-2 h-4 w-4" viewBox="0 0 24 24">
                        <path
                            d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"
                            fill="#4285F4"
                        />
                        <path
                            d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"
                            fill="#34A853"
                        />
                        <path
                            d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"
                            fill="#FBBC05"
                        />
                        <path
                            d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"
                            fill="#EA4335"
                        />
                    </svg>
                    Continuar con Google
                </Button>
            </div>

            <p className="mt-8 text-center text-xs text-muted-foreground opacity-50">
                &copy; {new Date().getFullYear()} CleanApp Piso.
            </p>
        </div>
    );
}

export default LoginPage;

--- src/pages/Profile.tsx ---
import { useNavigate } from "react-router-dom";
import { useAuth } from "@/auth/AuthProvider";
import { auth } from "@/auth/auth";
import { useTitle } from "@/hooks/useTitle";
import { useHistory } from "@/hooks/useHistory";
import { Avatar } from "@/components/ui/Avatar";
import { UserHistory } from "@/components/UserHistory";
import { CLEANERS } from "@/config/cleaners";
import { ArrowLeft, LogOut, Mail } from "lucide-react";
import { Button } from "@/components/ui/button"; // Usamos el botÃ³n de shadcn si lo tienes, o un HTML button simple

export function ProfilePage() {
  useTitle("Mi Perfil - CleanApp");
  const { user } = useAuth();
  const navigate = useNavigate();

  // 1. Obtener datos centralizados
  const userProfile = Object.values(CLEANERS).find(
    (c) => c.email === user?.email,
  );

  // 2. Hook de historial
  const { history, loading: historyLoading } = useHistory(user?.email);

  const handleBack = () => navigate(-1);
  const handleLogout = async () => {
    await auth.logout();
    navigate("/login");
  };

  if (!userProfile) {
    return (
      <div className="flex h-screen items-center justify-center text-gray-400">
        Usuario no configurado en el sistema.
      </div>
    );
  }

  return (
    <div className="min-h-screen w-full bg-zinc-950 text-white flex flex-col animate-in fade-in duration-500">
      {/* Navbar Simple */}
      <header className="sticky top-0 z-10 flex items-center justify-between p-4 md:px-8 border-b border-white/5 bg-zinc-950/80 backdrop-blur-md">
        <button
          onClick={handleBack}
          className="flex items-center gap-2 text-gray-400 hover:text-white transition-colors"
        >
          <ArrowLeft size={20} />
          <span className="text-sm font-medium">Volver</span>
        </button>
        <span className="text-sm font-bold text-gray-500 tracking-widest uppercase">
          Perfil
        </span>
      </header>

      <main className="flex-1 container max-w-3xl mx-auto px-4 py-8 flex flex-col gap-8">
        {/* Tarjeta de Identidad */}
        <section className="relative overflow-hidden rounded-3xl bg-zinc-900 border border-white/5 p-6 md:p-10 text-center shadow-2xl">
          {/* Fondo decorativo sutil */}
          <div
            className={`absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-${userProfile.themeColor}-900/20 to-transparent opacity-50`}
          />

          <div className="relative z-10 flex flex-col items-center gap-4">
            <div className="group relative">
              {/* Glow effect detrÃ¡s del avatar */}
              <div
                className={`absolute -inset-1 rounded-full blur-xl opacity-20 bg-${userProfile.themeColor}-500 group-hover:opacity-40 transition-opacity duration-500`}
              />

              <Avatar
                size="xl"
                src={userProfile.avatarUrl}
                alt={userProfile.name}
                colorTheme={userProfile.themeColor}
                className="relative shadow-2xl"
              />
            </div>

            <div className="space-y-1">
              <h1 className="text-3xl md:text-4xl font-bold tracking-tight text-white">
                {userProfile.name}
              </h1>
              <div className="flex items-center justify-center gap-2 text-gray-400 text-sm">
                <Mail size={14} />
                <span>{userProfile.email}</span>
              </div>
            </div>
          </div>
        </section>

        {/* SecciÃ³n Historial */}
        <section>
          {historyLoading ? (
            <div className="text-center text-gray-500 py-10 animate-pulse">
              Cargando historial...
            </div>
          ) : (
            <UserHistory history={history} />
          )}
        </section>

        {/* Zona de Peligro / Logout */}
        <div className="mt-auto pt-8 flex justify-center">
          <Button
            variant="destructive"
            onClick={handleLogout}
            className="gap-2 font-semibold shadow-lg shadow-red-900/20"
          >
            <LogOut size={16} />
            Cerrar SesiÃ³n
          </Button>
        </div>
      </main>
    </div>
  );
}

--- src/pages/Ranking.tsx ---
import { useRanking, type RankingItem } from "@/hooks/useRanking";
import { useTitle } from "@/hooks/useTitle";
import { Avatar } from "@/components/ui/Avatar";
import { Trophy } from "lucide-react";

export default function RankingPage() {
  useTitle("Ranking de Limpieza");
  const { ranking, loading } = useRanking();

  if (loading) {
    return (
      <div className="p-10 text-center text-white animate-pulse">
        Calculando puntuaciones...
      </div>
    );
  }

  const [top1, top2, top3, ...rest] = ranking;

  return (
    <div className="flex flex-col gap-8 pb-10">
      {/* Header */}
      <header className="mt-8 text-center space-y-2 animate-in fade-in slide-in-from-top-4 duration-700">
        <div className="inline-flex p-3 rounded-full bg-yellow-500/20 text-yellow-400 mb-2 ring-1 ring-yellow-500/50 shadow-[0_0_15px_rgba(234,179,8,0.3)]">
          <Trophy size={32} />
        </div>
        <h1 className="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-br from-yellow-200 via-yellow-400 to-yellow-600">
          SalÃ³n de la Fama
        </h1>
        <p className="text-gray-400">
          Â¿QuiÃ©n es el verdadero seÃ±or de la limpieza?
        </p>
      </header>

      {/* PODIO */}
      <div className="flex justify-center items-end gap-4 md:gap-8 mt-12 px-4 h-[300px]">
        {/* TOP 2 */}
        {top2 && <PodiumStep user={top2} place={2} delay={200} />}

        {/* TOP 1 */}
        {top1 && <PodiumStep user={top1} place={1} delay={0} />}

        {/* TOP 3 */}
        {top3 && <PodiumStep user={top3} place={3} delay={400} />}
      </div>

      {/* Resto de mortales */}
      <div className="max-w-2xl mx-auto w-full px-4 flex flex-col gap-3">
        {rest.map((user, index) => (
          <div
            key={user.id}
            className="flex items-center gap-4 p-4 rounded-xl bg-white/5 border border-white/10 animate-in slide-in-from-bottom-2 fade-in fill-mode-backwards"
            style={{ animationDelay: `${(index + 3) * 100}ms` }}
          >
            <span className="font-bold text-gray-500 w-6 text-center">
              #{index + 4}
            </span>
            <Avatar
              src={user.avatarUrl}
              alt={user.name}
              size="sm"
              colorTheme={user.themeColor}
            />
            <div className="flex-1">
              <h3 className="font-bold text-white">{user.name}</h3>
            </div>
            <div className="text-right">
              <span className="block text-xl font-bold text-white">
                {user.score}
              </span>
              <span className="text-xs text-gray-500">ptos</span>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
}

// Subcomponente para el Podio
function PodiumStep({
  user,
  place,
  delay,
}: {
  user: RankingItem;
  place: number;
  delay: number;
}) {
  // ConfiguraciÃ³n visual segÃºn posiciÃ³n
  const config = {
    1: {
      height: "h-[220px]",
      color: "bg-gradient-to-t from-yellow-600/80 to-yellow-400/20",
      border: "border-yellow-500",
      iconColor: "text-yellow-400",
    },
    2: {
      height: "h-[160px]",
      color: "bg-gradient-to-t from-slate-600/80 to-slate-400/20",
      border: "border-slate-400",
      iconColor: "text-slate-300",
    },
    3: {
      height: "h-[130px]",
      color: "bg-gradient-to-t from-orange-800/80 to-orange-600/20",
      border: "border-orange-600",
      iconColor: "text-orange-400",
    },
  }[place];

  return (
    <div
      className={`flex flex-col items-center justify-end w-1/3 max-w-[140px] animate-in slide-in-from-bottom-10 fade-in duration-1000 fill-mode-backwards`}
      style={{ animationDelay: `${delay}ms` }}
    >
      {/* Avatar flotante */}
      <div className="mb-[-20px] z-10 relative">
        <Avatar
          src={user.avatarUrl}
          alt={user.name}
          size={place === 1 ? "lg" : "md"}
          colorTheme={user.themeColor}
          className="shadow-2xl"
        />
        {place === 1 && (
          <div className="absolute -top-6 left-1/2 -translate-x-1/2 animate-bounce">
            <Trophy
              className="text-yellow-400 fill-yellow-400 drop-shadow-lg"
              size={24}
            />
          </div>
        )}
      </div>

      {/* Barra del podio */}
      <div
        className={`w-full ${config?.height} ${config?.color} rounded-t-xl border-t border-x ${config?.border} backdrop-blur-md flex flex-col items-center justify-start pt-8 relative overflow-hidden group`}
      >
        <div className="absolute inset-0 bg-white/5 opacity-0 group-hover:opacity-100 transition-opacity" />

        <h3 className="font-bold text-white text-lg md:text-xl truncate max-w-full px-2">
          {user.name}
        </h3>
        <div className="flex items-baseline gap-1 mt-1">
          <span className="text-2xl md:text-3xl font-black text-white">
            {user.score}
          </span>
          <span className="text-xs text-gray-300">ptos</span>
        </div>

        <div
          className={`mt-auto mb-4 font-black text-4xl opacity-20 ${config?.iconColor}`}
        >
          {place}
        </div>
      </div>
    </div>
  );
}

--- src/services/cleaningService.ts ---
import { get, ref, set, update, increment } from "firebase/database";
import { db } from "@/firebase/firebase";
import { DB_PATHS } from "./paths";
import {
  getPreciseDateString,
  getWeekBounds,
  getWeekOfYear,
} from "@/utils/date";
import { getTaskForUser } from "@/utils/taskRotation"; // Creado en Fase 1
import { CLEANER_LIST } from "@/config/cleaners"; // Creado en Fase 1
import type { CleanerProfile } from "@/types/domain";

/**
 * Inicializa la semana en la DB si no existe.
 * Implementa el patrÃ³n "Check-then-Act" de forma atÃ³mica.
 */
export async function initializeCurrentWeekIfNeeded(): Promise<void> {
  const weekPath = DB_PATHS.currentWeekRoot();
  const weekRef = ref(db, weekPath);

  const snapshot = await get(weekRef);
  if (snapshot.exists()) return; // Ya existe, no hacemos nada.

  // Datos para inicializar
  const weekNumber = getWeekOfYear();
  const weekBounds = getWeekBounds();

  // Construimos el estado inicial de cada usuario usando la configuraciÃ³n central
  const initialUsersState = CLEANER_LIST.reduce(
    (acc, cleaner) => {
      acc[cleaner.username] = {
        name: cleaner.name,
        task: getTaskForUser(cleaner.username, weekNumber),
        done: false,
        fecha: "not done",
      };
      return acc;
    },
    {} as Record<string, any>,
  );

  console.info(`ğŸ“… Inicializando semana ${weekBounds}...`);

  await set(weekRef, {
    year: new Date().getFullYear(),
    weekNumber,
    week: weekBounds,
    usuarios: initialUsersState,
  });
}

/**
 * Alterna el estado de una tarea (Hecho/Pendiente)
 * y actualiza el historial personal del usuario simultÃ¡neamente.
 */
export async function toggleTaskCompletion(
  cleaner: CleanerProfile,
  currentTaskName: string,
): Promise<boolean> {
  // 1. Obtener estado actual
  const userPath = DB_PATHS.weeklyUserStatus(cleaner.username);
  const userRef = ref(db, userPath);
  const snapshot = await get(userRef);

  if (!snapshot.exists())
    throw new Error("Usuario no encontrado en la semana actual");

  const data = snapshot.val();
  const newStatus = !data.done;
  const newDate = newStatus ? getPreciseDateString() : "not done";

  // 2. Preparar actualizaciones atÃ³micas
  const updates: Record<string, any> = {};

  // A) Actualizar semana actual
  updates[`${userPath}/done`] = newStatus;
  updates[`${userPath}/fecha`] = newDate;

  // B) Actualizar historial de pendientes
  const currentWeekId = getWeekBounds();
  const historyPath = DB_PATHS.userHistoryItem(cleaner.email, currentWeekId);

  if (newStatus === false) {
    updates[historyPath] = currentTaskName;
  } else {
    updates[historyPath] = null;
  }

  // Si completa (true) sumamos 1, si desmarca (false) restamos 1
  const statsPath = DB_PATHS.userStats(cleaner.username);
  updates[`${statsPath}/completedTasks`] = increment(newStatus ? 1 : -1);

  // Ejecutamos TODO a la vez
  await update(ref(db), updates);

  return newStatus;
}

--- src/services/paths.ts ---
import { getWeekBounds } from "@/utils/date";
import { cleanEmail } from "@/utils/users";

const ROOT_STATS = "stats"; // Nuevo nodo raÃ­z
const ROOT_APP = "piso";
const ROOT_USERS = "users";

// Helper para sanitizar strings en claves de Firebase (evita repetir replaceAll)
const sanitize = (str: string) => str.replaceAll("/", "_").replaceAll(".", "_");

export const DB_PATHS = {
  // Ruta RaÃ­z de la semana actual: piso/12_05_2025-18_05_2025/
  currentWeekRoot: () => {
    const weekId = sanitize(getWeekBounds());
    return `${ROOT_APP}/${weekId}`;
  },

  // Ruta de un usuario especÃ­fico en la semana: piso/.../usuarios/rubius
  weeklyUserStatus: (username: string) => {
    return `${DB_PATHS.currentWeekRoot()}/usuarios/${username}`;
  },

  // Ruta especÃ­fica de un item en el historial: users/rubius/history/12_05_2025-18_05_2025
  userHistoryItem: (email: string, weekId: string) => {
    return `${ROOT_USERS}/${cleanEmail(email)}/history/${sanitize(weekId)}`;
  },

  // Ruta raÃ­z del historial de un usuario
  userHistoryRoot: (email: string) => {
    return `${ROOT_USERS}/${cleanEmail(email)}/history`;
  },
  userStats: (username: string) => {
    return `${ROOT_STATS}/${username}`;
  },

  // Ruta para leer todos los stats (para la lista del ranking)
  allStats: () => {
    return `${ROOT_STATS}`;
  },
};

--- src/types/domain.ts ---
export type BrandColor = "blue" | "green" | "purple" | "yellow" | "pink";

export interface CleanerProfile {
  id: string;
  username: string;
  email: string;
  name: string;
  avatarUrl: string;
  themeColor: BrandColor;
}

export interface WeeklyTaskState {
  taskName: string;
  isDone: boolean;
  completedAt: string | null;
}

export interface CleanerWithTask extends CleanerProfile, WeeklyTaskState {}

export interface HistoryRecord {
  weekId: string; // ej: "23-05-2025/30-05-2025"
  taskName: string;
}

export interface UserStats {
  username: string;
  completedTasks: number;
}

--- src/utils/date.ts ---
export function getPreciseDateString() {
    const today = new Date()
    const day = String(today.getDate()).padStart(2, '0')
    const month = String(today.getMonth() + 1).padStart(2, '0') // Los meses van de 0 a 11
    const year = today.getFullYear()
    const hour = today.getHours()
    const minutes = today.getMinutes()

    return `${day}/${month}/${year} ${hour}:${minutes}`
}
export function getDayString(date: Date) {
    const day = String(date.getDate()).padStart(2, '0')
    const month = String(date.getMonth() + 1).padStart(2, '0') // Los meses van de 0 a 11
    const year = date.getFullYear()

    return `${day}/${month}/${year}`
}

export function getWeekBounds(current: Date = new Date()) {
    const day = current.getDay();
    const diffToMonday = day === 0 ? -6 : 1 - day;

    const monday = new Date(current);
    monday.setDate(current.getDate() + diffToMonday);

    const sunday = new Date(monday);
    sunday.setDate(monday.getDate() + 6);
    return `${getDayString(monday)}-${getDayString(sunday)}`
}

export function getWeekOfYear() {
    const date = new Date()
    // Creamos una copia de la fecha y la ajustamos a medianoche
    const target = new Date(date.valueOf())
    target.setHours(0, 0, 0, 0)

    // ISO-8601: el lunes es el primer dÃ­a de la semana.
    // Calculamos el jueves de la semana actual
    const dayNr = (date.getDay() + 6) % 7
    target.setDate(target.getDate() - dayNr + 3)

    // Obtenemos el primer jueves del aÃ±o
    const firstThursday = new Date(target.getFullYear(), 0, 4)
    const firstDayNr = (firstThursday.getDay() + 6) % 7
    firstThursday.setDate(firstThursday.getDate() - firstDayNr + 3)

    // Calculamos la diferencia en semanas
    const weekNumber = 1 + Math.round((target.getTime() - firstThursday.getTime()) / (7 * 24 * 3600 * 1000))
    return weekNumber
}


export function getMonday() {
    const today = new Date();
    const day = today.getDay();
    const diffToMonday = day === 0 ? -6 : 1 - day;

    const monday = new Date(today);
    monday.setDate(today.getDate() + diffToMonday);
    return monday
}




--- src/utils/isIOS.ts ---
export function isIOSSafari() {
    const ua = window.navigator.userAgent
    return /IP(ad|hone|od)/.test(ua) && /Safari/.test(ua) && !/CriOS|FxiOS/.test(ua)
}

--- src/utils/taskRotation.ts ---
const TASKS_POOL = ["Cocina", "Cocina", "SalÃ³n", "Pasillo"];

/**
 * Calcula quÃ© tareas tocan en una semana especÃ­fica basÃ¡ndose en la rotaciÃ³n.
 * FunciÃ³n pura: Inputs -> Outputs. Sin hooks.
 */
export function getTasksForWeek(weekNumber: number): string[] {
  const shift = weekNumber % 4;
  // RotaciÃ³n simple del array
  return [...TASKS_POOL.slice(4 - shift), ...TASKS_POOL.slice(0, 4 - shift)];
}

/**
 * Asigna tarea a un usuario especÃ­fico basado en el orden estÃ¡tico.
 * Asumimos el orden: Rubius, Alvaro, Victor, Alex
 */
export function getTaskForUser(username: string, weekNumber: number): string {
  const tasks = getTasksForWeek(weekNumber);
  switch (username) {
    case "rubius":
      return tasks[0];
    case "alvaro":
      return tasks[1];
    case "victor":
      return tasks[2];
    case "alex":
      return tasks[3];
    default:
      return "Sin tarea";
  }
}

--- src/utils/users.ts ---
export function cleanEmail(email: string) {
    return email.split("@")[0]
} 

--- src/vite-env.d.ts ---
/// <reference types="vite/client" />

--- tsconfig.app.json ---
{
  "compilerOptions": {
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.app.tsbuildinfo",
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    },
    "target": "ES2022",
    "useDefineForClassFields": true,
    "lib": ["ES2022", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["src"]
}

--- tsconfig.json ---
{
  "files": [],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  },
  "references": [
    {
      "path": "./tsconfig.app.json"
    },
    {
      "path": "./tsconfig.node.json"
    }
  ]
}

--- tsconfig.node.json ---
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    },
    "tsBuildInfoFile": "./node_modules/.tmp/tsconfig.node.tsbuildinfo",
    "target": "ES2023",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "verbatimModuleSyntax": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": true,
    "noUnusedParameters": true,
    "erasableSyntaxOnly": true,
    "noFallthroughCasesInSwitch": true,
    "noUncheckedSideEffectImports": true
  },
  "include": ["vite.config.ts"]
}

--- vite.config.ts ---
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import tailwindcss from "@tailwindcss/vite";
import path from "path";

export default defineConfig({
    plugins: [react(), tailwindcss()],
    resolve: {
        alias: {
            "@": path.resolve(__dirname, "./src"),
        },
    },
});

